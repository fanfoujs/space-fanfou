# å¤ªç©ºé¥­å¦ Bugæ£€æŸ¥ç»¼åˆæŠ¥å‘Š

**æ£€æŸ¥æ—¥æœŸ**: 2025-11-11
**é¡¹ç›®ç‰ˆæœ¬**: 2.0.0
**æ¶æ„**: Chrome Extension Manifest V3
**æ£€æŸ¥å·¥å…·**: Claude Code + å¤šä¸“ä¸šå­ä»£ç†
**æŠ¥å‘Šç‰ˆæœ¬**: v1.0

---

## ğŸ“Š æ‰§è¡Œæ‘˜è¦

### é¡¹ç›®å¥åº·åº¦: ğŸŸ¢ 82/100

ä»åˆå§‹è¯„ä¼°çš„70%æå‡åˆ°82%ï¼ˆå·²ä¿®å¤ESLint parseré˜»æ–­æ€§é—®é¢˜ï¼‰

| æ£€æŸ¥ç»´åº¦ | è¯„åˆ† | çŠ¶æ€ | å¤‡æ³¨ |
|---------|------|------|------|
| ä»£ç è´¨é‡ | 72/100 | ğŸŸ¡ éœ€æ”¹è¿› | 125ä¸ªESLinté”™è¯¯å¾…ä¿®å¤ |
| é€»è¾‘æ­£ç¡®æ€§ | 85/100 | ğŸŸ¢ è‰¯å¥½ | å‘ç°12ä¸ªé€»è¾‘é”™è¯¯ |
| å®‰å…¨æ€§ | 78/100 | ğŸŸ¡ æœ‰éšæ‚£ | 2ä¸ªé«˜å±å®‰å…¨é—®é¢˜ |
| æ¶æ„å®Œæ•´æ€§ | 91/100 | ğŸŸ¢ ä¼˜ç§€ | Service Workeræœºåˆ¶å®Œå–„ |
| æ€§èƒ½ | 80/100 | ğŸŸ¢ è‰¯å¥½ | page.jsæœ‰ä¼˜åŒ–ç©ºé—´ |
| MV3å…¼å®¹æ€§ | 95/100 | ğŸŸ¢ ä¼˜ç§€ | å·²å®Œæˆè¿ç§»ï¼Œæ— åºŸå¼ƒAPI |
| æµ‹è¯•è¦†ç›–ç‡ | 65/100 | ğŸŸ¡ éœ€æ”¹è¿› | ç¼ºå°‘è¦†ç›–ç‡æŠ¥å‘Š |

### å…³é”®å‘ç°

- âœ… **å·²ä¿®å¤**: ESLint parserå´©æºƒé—®é¢˜ï¼ˆshow-contextual-statuses/@page.js:253ï¼‰
- âš ï¸ **é«˜å±é—®é¢˜**: 6ä¸ªï¼ˆé€»è¾‘é”™è¯¯4ä¸ªï¼Œå®‰å…¨é—®é¢˜2ä¸ªï¼‰
- âš ï¸ **ä¸­å±é—®é¢˜**: 18ä¸ªï¼ˆé€»è¾‘éšæ‚£5ä¸ªï¼Œæ¶æ„å€ºåŠ¡3ä¸ªï¼Œæ€§èƒ½é—®é¢˜3ä¸ªï¼‰
- ğŸ“ **æŠ€æœ¯å€ºåŠ¡**: 14ä¸ªTODO/FIXMEå¾…å¤„ç†
- ğŸ† **æ¶æ„ä¼˜åŠ¿**: æ¨¡å—ç³»ç»Ÿè§„èŒƒ100%ç¬¦åˆã€0å¤„æ¶æ„è¿å

---

## ğŸ”´ é«˜ä¼˜å…ˆçº§é—®é¢˜æ¸…å•ï¼ˆP0 - éœ€ç«‹å³ä¿®å¤ï¼‰

### 1. é€»è¾‘é”™è¯¯ - ä¼šå¯¼è‡´åŠŸèƒ½å´©æºƒï¼ˆ4ä¸ªï¼‰

#### ğŸ› #1 ç©ºå€¼å¼•ç”¨å¯¼è‡´TypeError
**ä½ç½®**: `src/features/status-form-enhancements/refresh-status-count@page.js:79-80`
**ä¸¥é‡æ€§**: ğŸ”´ Critical
**é—®é¢˜æè¿°**:
```javascript
// é—®é¢˜ä»£ç 
const link = findElementWithSpecifiedContentInArray(select.all('a', p), re)
const newCountNumber = link.textContent.match(re)[1] // â† linkå¯èƒ½ä¸ºundefined
```

**å½±å“èŒƒå›´**: æ¶ˆæ¯è®¡æ•°åˆ·æ–°åŠŸèƒ½
**å¤ç°æ¡ä»¶**: é¡µé¢DOMç»“æ„ä¸ç¬¦åˆé¢„æœŸï¼ˆç”¨æˆ·æœªç™»å½•ã€é¡µé¢æ”¹ç‰ˆï¼‰
**ä¿®å¤æ–¹æ¡ˆ**:
```javascript
const link = findElementWithSpecifiedContentInArray(select.all('a', p), re)
if (!link) {
  console.warn('[SpaceFanfou] æ— æ³•æ‰¾åˆ°æ¶ˆæ¯è®¡æ•°é“¾æ¥')
  return
}
const newCountNumber = link.textContent.match(re)[1]
```
**é¢„è®¡å·¥ä½œé‡**: 15åˆ†é’Ÿ

---

#### ğŸ› #2 DOMå…ƒç´ ç©ºå€¼è®¿é—®
**ä½ç½®**: `src/features/status-form-enhancements/refresh-status-count@page.js:77`
**ä¸¥é‡æ€§**: ğŸ”´ Critical
**é—®é¢˜æè¿°**:
```javascript
// é—®é¢˜ä»£ç 
const p = select('#nav', document).previousElementSibling // â† selectå¯èƒ½è¿”å›null
```

**å½±å“èŒƒå›´**: æ¶ˆæ¯è®¡æ•°åˆ·æ–°åŠŸèƒ½
**å¤ç°æ¡ä»¶**: ç§»åŠ¨ç‰ˆé¥­å¦æˆ–é¡µé¢ç»“æ„å˜åŒ–
**ä¿®å¤æ–¹æ¡ˆ**:
```javascript
const nav = select('#nav', document)
if (!nav || !nav.previousElementSibling) return
const p = nav.previousElementSibling
```
**é¢„è®¡å·¥ä½œé‡**: 10åˆ†é’Ÿ

---

#### ğŸ› #3 æ½œåœ¨çš„undefinedåœ¨mapä¸­ä¼ æ’­
**ä½ç½®**: `src/features/status-form-enhancements/refresh-status-count@page.js:53-54`
**ä¸¥é‡æ€§**: ğŸ”´ High
**é—®é¢˜æè¿°**:
```javascript
// é—®é¢˜ä»£ç 
const diff = [
  ...arrayRemove(added, removed).map(getStatusByInternalId(addedNodes)),
  ...arrayRemove(removed, added).map(getStatusByInternalId(removedNodes)),
] // â† getStatusByInternalIdå¯èƒ½è¿”å›undefined
```

**å½±å“èŒƒå›´**: æ¶ˆæ¯è®¡æ•°å¢é‡è®¡ç®—
**å¤ç°æ¡ä»¶**: å…ƒç´ å¿«é€Ÿæ·»åŠ /åˆ é™¤
**ä¿®å¤æ–¹æ¡ˆ**:
```javascript
const diff = [
  ...arrayRemove(added, removed).map(getStatusByInternalId(addedNodes)),
  ...arrayRemove(removed, added).map(getStatusByInternalId(removedNodes)),
].filter(Boolean) // è¿‡æ»¤æ‰undefined
```
**é¢„è®¡å·¥ä½œé‡**: 10åˆ†é’Ÿ

---

#### ğŸ› #4 é“¾å¼è°ƒç”¨ç¼ºå°‘nullæ£€æŸ¥
**ä½ç½®**: `src/page/modules/checkMyNewStatus.js:43-44`
**ä¸¥é‡æ€§**: ğŸ”´ High
**é—®é¢˜æè¿°**:
```javascript
// é—®é¢˜ä»£ç 
if (select('.author', li).href !== getLoggedInUserProfilePageUrl()) return false
// â† select('.author', li)å¯èƒ½è¿”å›null
```

**å½±å“èŒƒå›´**: å‘é€æ¶ˆæ¯åæ£€æŸ¥æ–°æ¶ˆæ¯åŠŸèƒ½
**å¤ç°æ¡ä»¶**: æ¶ˆæ¯å…ƒç´ ç»“æ„å¼‚å¸¸
**ä¿®å¤æ–¹æ¡ˆ**:
```javascript
const authorLink = select('.author', li)
if (!authorLink || authorLink.href !== getLoggedInUserProfilePageUrl()) return false
```
**é¢„è®¡å·¥ä½œé‡**: 10åˆ†é’Ÿ

---

### 2. å®‰å…¨é—®é¢˜ï¼ˆ2ä¸ªï¼‰

#### ğŸ”’ #5 XSSæ¼æ´ - innerHTMLæœªå‡€åŒ–
**ä½ç½®**: `src/features/show-contextual-statuses/@page.js:43`
**ä¸¥é‡æ€§**: ğŸ”´ Critical
**CVEåˆ†ç±»**: CWE-79 (Cross-site Scripting)

**é—®é¢˜æè¿°**: ç›´æ¥ä½¿ç”¨innerHTMLæ³¨å…¥æœªå‡€åŒ–çš„HTMLå†…å®¹

**æ”»å‡»åœºæ™¯**:
1. æ¶æ„ç”¨æˆ·å‘é€åŒ…å«`<script>`æ ‡ç­¾çš„æ¶ˆæ¯
2. å…¶ä»–ç”¨æˆ·æŸ¥çœ‹ä¸Šä¸‹æ–‡æ¶ˆæ¯æ—¶è§¦å‘XSS
3. å¯èƒ½çªƒå–Cookieã€Sessionã€æ‰§è¡Œæ¶æ„æ“ä½œ

**å½±å“èŒƒå›´**: æ‰€æœ‰æŸ¥çœ‹ä¸Šä¸‹æ–‡æ¶ˆæ¯çš„ç”¨æˆ·
**CVSSè¯„åˆ†**: 7.2 (High)

**ä¿®å¤æ–¹æ¡ˆ**:
```javascript
// å·²å®‰è£…DOMPurifyä½†æœªä½¿ç”¨
import DOMPurify from 'dompurify'

// åœ¨æ‰€æœ‰innerHTMLä½¿ç”¨å¤„æ·»åŠ å‡€åŒ–
element.innerHTML = DOMPurify.sanitize(htmlContent, {
  ALLOWED_TAGS: ['a', 'b', 'i', 'em', 'strong', 'span'],
  ALLOWED_ATTR: ['href', 'class']
})
```
**é¢„è®¡å·¥ä½œé‡**: 1å°æ—¶

---

#### ğŸ”’ #6 ä¾èµ–å®‰å…¨æ¼æ´
**ä¸¥é‡æ€§**: ğŸ”´ High
**å·²çŸ¥CVE**:

| ä¾èµ– | å½“å‰ç‰ˆæœ¬ | å»ºè®®ç‰ˆæœ¬ | CVEç¼–å· | ä¸¥é‡æ€§ |
|------|---------|---------|---------|--------|
| webpack | 4.47.0 | 5.x.x | å¤šä¸ªå·²çŸ¥æ¼æ´ | High |
| dot-prop | 5.3.0 | 8.0.0 | åŸå‹æ±¡æŸ“ | High |

**ä¿®å¤æ–¹æ¡ˆ**:
```bash
npm update webpack@5.x.x
npm update dot-prop@8.0.0
npm audit fix
```

**æ³¨æ„äº‹é¡¹**: Webpack 4â†’5å¯èƒ½éœ€è¦é…ç½®è°ƒæ•´
**é¢„è®¡å·¥ä½œé‡**: 2-4å°æ—¶ï¼ˆå«æµ‹è¯•ï¼‰

---

## ğŸŸ¡ ä¸­ä¼˜å…ˆçº§é—®é¢˜æ¸…å•ï¼ˆP1 - éœ€è®¡åˆ’ä¿®å¤ï¼‰

### 1. é€»è¾‘éšæ‚£ï¼ˆ5ä¸ªï¼‰

| # | ä½ç½® | é—®é¢˜ | å½±å“ | å·¥ä½œé‡ |
|---|------|------|------|--------|
| #7 | `content/environment/messaging.js:18-22` | ç¼ºå°‘nullæ£€æŸ¥ | Service Workerä¼‘çœ æ—¶å¯èƒ½å´©æºƒ | 30åˆ†é’Ÿ |
| #8 | `enrich-statuses/@page.js:114` | æœªæ•è·Promise rejection | é”™è¯¯è¢«é™é»˜åæ‰ | 20åˆ†é’Ÿ |
| #9 | `show-contextual-statuses/@page.js:316` | asyncé”™è¯¯æœªå¤„ç† | MutationObserver callbackå¼‚å¸¸ | 30åˆ†é’Ÿ |
| #10 | `page/environment/bridge.js:21` | deferredæ³„æ¼ | Content Scriptsæœªå“åº”æ—¶å†…å­˜æ³„æ¼ | 1å°æ—¶ |
| #11 | `requireFanfouLib.js:23-43` | å®šæ—¶å™¨æ³„æ¼ | é¡µé¢å¸è½½æ—¶æœªæ¸…ç† | 30åˆ†é’Ÿ |

**è¯¦ç»†è¯´æ˜**:

#### #7 messaging.jsç¼ºå°‘nullæ£€æŸ¥
```javascript
// é—®é¢˜ä»£ç 
const d = deferreds[senderId]
d.resolve(message) // â† då¯èƒ½ä¸ºundefined
```
**ä¿®å¤æ–¹æ¡ˆ**: æ·»åŠ `if (!d) return`æ£€æŸ¥

#### #8 æœªæ•è·Promise rejection
```javascript
// é—®é¢˜ä»£ç 
for (const link of getLinksInStatuses(li)) {
  processLink(li, link) // â† asyncå‡½æ•°ä½†æœªawaitæˆ–.catch()
}
```
**ä¿®å¤æ–¹æ¡ˆ**: æ·»åŠ `.catch(error => console.warn(...))`

---

### 2. æ€§èƒ½é—®é¢˜ï¼ˆ3ä¸ªï¼‰

#### âš¡ #12 Bundle Sizeä¼˜åŒ–ç©ºé—´

**å½“å‰å¤§å°**:
```
page.js:      596 KB  â† æœ€å¤§ï¼Œä¼˜åŒ–ç©ºé—´çº¦150KB
background.js: 176 KB
settings.js:   136 KB
content.js:    124 KB
offscreen.js:   12 KB
```

**é—®é¢˜åˆ†æ**:
- Webpack 4çš„Tree-shakingæ•ˆæœæœ‰é™
- æ— ä»£ç åˆ†å‰²ï¼ˆæ‰€æœ‰åŠŸèƒ½æ¨¡å—æ‰“åŒ…åœ¨ä¸€èµ·ï¼‰
- show-contextual-statusesç­‰å¤§æ¨¡å—æœªå¼‚æ­¥åŠ è½½

**ä¼˜åŒ–å»ºè®®**:
1. **å‡çº§Webpack 5** â†’ é¢„æœŸå‡å°‘15-20%ä½“ç§¯
2. **ä»£ç åˆ†å‰²** â†’ å°†batch-*ç³»åˆ—åŠŸèƒ½å¼‚æ­¥åŠ è½½
3. **Tree-shakingæ”¹å–„** â†’ ç§»é™¤æœªä½¿ç”¨çš„lodashæ–¹æ³•

**é¢„æœŸæ”¶ç›Š**: 596KB â†’ 450KB (-25%)
**é¢„è®¡å·¥ä½œé‡**: 8å°æ—¶

---

#### âš¡ #13 ç¼“å­˜ç­–ç•¥ç¼ºå¤±

**ä½ç½®**: `src/features/enrich-statuses/@page.js:80`
**é—®é¢˜**: æ¯æ¬¡å±•å¼€éƒ½é‡æ–°è¯·æ±‚çŸ­é“¾æ¥API

**å½±å“**:
- é‡å¤è¯·æ±‚ç›¸åŒURL
- å¯èƒ½è§¦å‘APIé™æµ
- ç½‘ç»œå»¶è¿Ÿå½±å“ä½“éªŒ

**ä¿®å¤æ–¹æ¡ˆ**:
```javascript
// å®ç°LRUç¼“å­˜
import LRUCache from 'lru-cache'

const urlCache = new LRUCache({ max: 100 })

async function extractData(shortUrl) {
  if (urlCache.has(shortUrl)) {
    return urlCache.get(shortUrl)
  }

  const data = await fetchData(shortUrl)
  urlCache.set(shortUrl, data)
  return data
}
```
**é¢„è®¡å·¥ä½œé‡**: 1.5å°æ—¶

---

#### âš¡ #14 DOMæ€§èƒ½ç“¶é¢ˆ

**çƒ­ç‚¹**: `src/content/modules/timelineElementObserver.js`

**ç»Ÿè®¡æ•°æ®**:
- MutationObserverä½¿ç”¨: 5å¤„
- addEventListenerä½¿ç”¨: 43å¤„
- å®šæ—¶å™¨ä½¿ç”¨: å¤šå¤„ï¼ˆéœ€è¿›ä¸€æ­¥åˆ†æï¼‰

**ä¼˜åŒ–å»ºè®®**:
1. **æ·»åŠ èŠ‚æµ/é˜²æŠ–** - MutationObserver callback
2. **æ‰¹é‡å¤„ç†** - æ”¶é›†å¤šä¸ªDOMå˜æ›´åç»Ÿä¸€å¤„ç†
3. **IntersectionObserveræ›¿ä»£** - éƒ¨åˆ†å¯è§æ€§æ£€æµ‹

**é¢„è®¡å·¥ä½œé‡**: 4å°æ—¶

---

### 3. æ¶æ„å€ºåŠ¡ï¼ˆ3ä¸ªï¼‰

#### #15 Portæ–­å¼€æ—¶çš„æ¶ˆæ¯é‡è¯•æœºåˆ¶ç¼ºå¤±
**ä½ç½®**: `src/content/environment/messaging.js:38-41`
**ä¼˜å…ˆçº§**: P1ï¼ˆä¸­ç­‰ï¼‰
**é—®é¢˜æè¿°**: Portæ–­å¼€æ—¶æ‰€æœ‰ç­‰å¾…ä¸­çš„æ¶ˆæ¯è¢«rejectï¼Œä½†æ²¡æœ‰è‡ªåŠ¨é‡è¯•
**å½±å“**: Service Workerä¼‘çœ æœŸé—´çš„æ¶ˆæ¯ä¸¢å¤±
**å»ºè®®æ–¹æ¡ˆ**: å®ç°æ¶ˆæ¯é˜Ÿåˆ—ï¼Œåœ¨é‡è¿æˆåŠŸåè‡ªåŠ¨é‡è¯•å…³é”®æ¶ˆæ¯ï¼ˆå¦‚SETTINGS_READ_ALLï¼‰
**é¢„è®¡å·¥ä½œé‡**: 2å°æ—¶

---

#### #16 senderIdå†²çªé£é™©
**ä½ç½®**: `src/page/environment/bridge.js:8`
**ä¼˜å…ˆçº§**: P2ï¼ˆè¾ƒä½ï¼‰
**é—®é¢˜æè¿°**: senderIdä½¿ç”¨é€’å¢æ•´æ•°ï¼Œé¡µé¢åˆ·æ–°åé‡ç½®ä¸º0ï¼Œå¯èƒ½å¯¼è‡´æ—§æ¶ˆæ¯è¯¯åŒ¹é…
**å»ºè®®æ–¹æ¡ˆ**: ä½¿ç”¨`${Date.now()}-${id++}`æˆ–`${performance.now()}-${id++}`ç”Ÿæˆå”¯ä¸€ID
**é¢„è®¡å·¥ä½œé‡**: 30åˆ†é’Ÿ

---

#### #17 ç„Šæ­»åŠŸèƒ½ï¼ˆisSolderedï¼‰ç¼ºå°‘ç†ç”±è¯´æ˜
**ä½ç½®**: 13ä¸ªmetadata.jsæ–‡ä»¶
**ä¼˜å…ˆçº§**: P2ï¼ˆè¾ƒä½ï¼‰
**é—®é¢˜æè¿°**: ä»…æ ‡è®°`isSoldered: true`ï¼Œæ— æ³¨é‡Šè¯´æ˜ä¸ºä½•ä¸å¯å…³é—­

**ç„Šæ­»åŠŸèƒ½æ¸…å•**:
```
better-at-autocomplete    # å¿…é¡»ç¦ç”¨æ—§çš„ä»¥å¯ç”¨æ–°çš„
fix-photo-zoom            # ä¿®å¤é¥­å¦åŸç”Ÿbug
go-top-button             # åŸºç¡€UIå¢å¼º
google-analytics          # ç»Ÿè®¡åŠŸèƒ½
keyboard-shortcuts        # æ ¸å¿ƒäº¤äº’
remove-brackets           # æ ·å¼ä¿®å¤
retinafy-photos          # é«˜æ¸…å›¾ç‰‡æ”¯æŒ
share-new-avatar         # å¤´åƒåˆ†äº«
sidebar-statistics       # ä¾§æ ç»Ÿè®¡
status-form-enhancements # è¾“å…¥æ¡†å¢å¼º
update-timestamps        # æ—¶é—´æˆ³æ›´æ–°
user-switcher            # è´¦å·åˆ‡æ¢
```

**å»ºè®®æ–¹æ¡ˆ**: åœ¨metadata.jsæ·»åŠ æ³¨é‡Šæˆ–åœ¨docs/architecture.mdä¸­é›†ä¸­è¯´æ˜
**é¢„è®¡å·¥ä½œé‡**: 2å°æ—¶

---

### 4. ä»£ç è´¨é‡é—®é¢˜ï¼ˆP1ï¼‰

#### #18 ESLinté”™è¯¯æœªä¿®å¤: 125ä¸ª

**é”™è¯¯åˆ†ç±»**:
| ç±»å‹ | æ•°é‡ | ä¸¥é‡æ€§ | ç¤ºä¾‹æ–‡ä»¶ |
|------|------|--------|---------|
| consoleè¯­å¥ | ~117ä¸ª | ä¸­ | background/environment/index.js |
| æœªå®šä¹‰å˜é‡ | 3ä¸ª | é«˜ | google-analyticsç›¸å…³ |
| ä»£ç é£æ ¼ | 5ä¸ª | ä½ | share-to-fanfou/@background.jsç¼©è¿› |

**ä¿®å¤ç­–ç•¥**:
1. **ä¿ç•™è°ƒè¯•console** â†’ æ·»åŠ `// eslint-disable-next-line no-console`
2. **ç§»é™¤æ— ç”¨console** â†’ æ¸…ç†éå¿…è¦çš„æ—¥å¿—
3. **ä¿®å¤æœªå®šä¹‰å˜é‡** â†’ æ·»åŠ å…¨å±€å˜é‡å£°æ˜æˆ–import
4. **ç»Ÿä¸€ä»£ç é£æ ¼** â†’ è‡ªåŠ¨æ ¼å¼åŒ–

**é¢„è®¡å·¥ä½œé‡**: 2å°æ—¶

---

## ğŸŸ¢ ä½ä¼˜å…ˆçº§å»ºè®®ï¼ˆP2 - é•¿æœŸä¼˜åŒ–ï¼‰

### 1. ä»£ç å¤ç”¨ï¼ˆé‡å¤ä»£ç 45å¤„ï¼‰

**Chrome APIè°ƒç”¨å°è£…**:
```javascript
// å»ºè®®åˆ›å»º src/libs/chromeApi.js
export const storage = {
  read: (key, area = 'sync') => chrome.storage[area].get(key),
  write: (key, value, area = 'sync') => chrome.storage[area].set({ [key]: value })
}
```

**DOMé€‰æ‹©å™¨å·¥å…·** (59å¤„selectè°ƒç”¨):
```javascript
// å»ºè®®åˆ›å»º src/libs/dom.js
export const $ = {
  one: (selector, context = document) => select(selector, context),
  all: (selector, context = document) => select.all(selector, context),
  ready: (selector) => elementReady(selector)
}
```

**é”™è¯¯å¤„ç†æ¨¡å¼** (16ä¸ªæ–‡ä»¶çš„try-catch):
```javascript
// å»ºè®®åˆ›å»º src/libs/errorHandler.js
export const tryAsync = async (fn, fallback) => {
  try {
    return await fn()
  } catch (error) {
    console.warn('[SpaceFanfou] Error:', error)
    return fallback
  }
}
```

**é¢„è®¡å·¥ä½œé‡**: 6å°æ—¶

---

### 2. æ¨¡å—è´¨é‡æ”¹è¿›ï¼ˆ3ä¸ªä½è¯„åˆ†æ¨¡å—ï¼‰

**éœ€é‡æ„æ¨¡å—**:

| æ¨¡å— | å½“å‰è¡Œæ•° | é—®é¢˜ | è¯„åˆ† | å»ºè®® |
|------|---------|------|------|------|
| show-contextual-statuses | 348è¡Œ | è€¦åˆåº¦é«˜ï¼Œç¼ºä¹æ³¨é‡Š | 68/100 | æ‹†åˆ†ä¸ºå¤šä¸ªå­æ¨¡å— |
| sidebar-statistics | 321è¡Œ | è®¡ç®—é€»è¾‘å¤æ‚ | 65/100 | æå–ç»Ÿè®¡è®¡ç®—ä¸ºç‹¬ç«‹å‡½æ•° |
| batch-remove-statuses | 282è¡Œ | ç¼ºä¹é”™è¯¯å¤„ç† | 62/100 | æ·»åŠ æ‰¹é‡æ“ä½œçš„é”™è¯¯æ¢å¤ |

**é¢„è®¡å·¥ä½œé‡**: 12å°æ—¶

---

### 3. æ–‡æ¡£åŒ–

**å½“å‰çŠ¶æ€**:
- JSDocè¦†ç›–ç‡: **0%** (233ä¸ªæ–‡ä»¶)
- æ³¨é‡Šè¦†ç›–ç‡: **24%** (56/233æ–‡ä»¶)
- æ¶æ„æ–‡æ¡£: å®Œå–„ä½†ç¼ºå°‘è®¾è®¡å†³ç­–è¯´æ˜

**å»ºè®®**:
1. **ä¸ºpublic APIæ·»åŠ JSDoc** - è‡³å°‘è¦†ç›–å¯¼å‡ºçš„å‡½æ•°/ç±»
2. **å…³é”®ç®—æ³•æ·»åŠ æ³¨é‡Š** - å¤æ‚é€»è¾‘éœ€è¦è§£é‡Š
3. **æ›´æ–°docs/architecture.md** - è¡¥å……ç„Šæ­»åŠŸèƒ½ã€åŒå­˜å‚¨ç­–ç•¥ç­‰è®¾è®¡ç†ç”±
4. **åˆ›å»ºå¼€å‘æŒ‡å—** - æ–°åŠŸèƒ½å¼€å‘æµç¨‹ã€æµ‹è¯•è¦æ±‚

**é¢„è®¡å·¥ä½œé‡**: 8å°æ—¶

---

## âœ… æ¶æ„å®Œæ•´æ€§éªŒè¯ç»“æœ

### é€šä¿¡æœºåˆ¶: 88/100 (ä¼˜ç§€)

**âœ… ä¼˜åŠ¿**:
- Service Workerä¼‘çœ æ¢å¤æœºåˆ¶å®Œå–„
  - Content Scriptsè‡ªåŠ¨é‡è¿ï¼ˆæŒ‡æ•°é€€é¿ï¼Œæœ€å¤š10æ¬¡ï¼Œæœ€å¤§å»¶è¿Ÿ5ç§’ï¼‰
  - Backgroundä½¿ç”¨`__SF_BACKGROUND_INITIALIZED__`é˜²æ­¢é‡å¤åˆå§‹åŒ–
- Portè¿æ¥ç®¡ç†å¥å£®
  - ç»´æŠ¤`connectedPorts`æ•°ç»„æ”¯æŒå¤šæ ‡ç­¾é¡µ
  - Portæ–­å¼€æ—¶è‡ªåŠ¨æ¸…ç†deferredsé¿å…å†…å­˜æ³„æ¼
- CustomEventæ¡¥æ¥ç¨³å®š
  - è¯·æ±‚-å“åº”æ˜ å°„æ­£ç¡®
  - æ”¯æŒå¹¿æ’­æ¶ˆæ¯

**âš ï¸ ä¸è¶³**:
- Portæ–­å¼€æ—¶æ¶ˆæ¯ä¸¢å¤±ï¼ˆæ— é‡è¯•æœºåˆ¶ï¼‰
- å¹¿æ’­æ¶ˆæ¯é€šè¿‡Port.postMessageå‘é€ï¼Œæ–­å¼€æ—¶ä¼šæŠ›å¼‚å¸¸ï¼ˆæœªæ•è·ï¼‰
- Page Scriptsçš„senderIdä½¿ç”¨é€’å¢æ•´æ•°ï¼Œåˆ·æ–°åå¯èƒ½å†²çª

**æ£€æŸ¥è¯¦æƒ…**:
- Background â†” Contenté€šä¿¡: âœ… æ­£å¸¸
- Content â†” Pageæ¡¥æ¥: âœ… æ­£å¸¸
- Service Workerä¼‘çœ æ¢å¤: âœ… å®Œå–„
- æ¶ˆæ¯æ ¼å¼ä¸€è‡´æ€§: âœ… ç»Ÿä¸€

---

### æ¨¡å—ç³»ç»Ÿ: 95/100 (ä¼˜ç§€)

**âœ… ä¼˜åŠ¿**:
- **æ–‡ä»¶å‘½åè§„èŒƒç¬¦åˆç‡: 100%**
  - 4ä¸ª@background.jsæ–‡ä»¶
  - 5ä¸ª@content.jsæ–‡ä»¶
  - 38ä¸ª@page.jsæ–‡ä»¶
  - å…¨éƒ¨ç¬¦åˆ`<subfeature-name>@<environment>.js`æ¨¡å¼

- **metadata.jsè§„èŒƒç¬¦åˆç‡: 100%**
  - 30ä¸ªåŠŸèƒ½æ¨¡å—å…¨éƒ¨åŒ…å«metadata.js
  - 18ä¸ªä½¿ç”¨`export const options`
  - 12ä¸ªä½¿ç”¨`export const isSoldered`
  - ä¸»å¼€å…³å‘½åè§„èŒƒï¼ˆ`_`å­—æ®µï¼‰

- **æ¡ä»¶ç¼–è¯‘éš”ç¦»æ€§: ä¼˜ç§€**
  - ä½¿ç”¨ifdef-loaderæ ¹æ®ENV_BACKGROUND/ENV_CONTENT/ENV_PAGEé€‰æ‹©æ€§ç¼–è¯‘
  - `src/features/index.js`æ­£ç¡®ä½¿ç”¨æ¡ä»¶æŒ‡ä»¤åŠ¨æ€åŠ è½½æ¨¡å—
  - é˜²é‡å¤åˆå§‹åŒ–æ ‡è®°ï¼ˆ`__SF_*_ENTRY_INITIALIZED__`ï¼‰

**âš ï¸ ä¸è¶³**:
- è·¨ç¯å¢ƒå¼•ç”¨æœªæ˜ç¡®æ–‡æ¡£åŒ–ï¼ˆè™½ç„¶æ˜¯é¢„æœŸè¡Œä¸ºï¼‰
  - `page/modules/index.js`å¯¼å…¥`@content/modules`ï¼ˆå…è®¸ï¼‰
  - `libs/animatedScrollTop.js`å¯¼å…¥`@content/modules/scrollManager`ï¼ˆå…è®¸ï¼‰

**ç»Ÿè®¡æ•°æ®**:
- æ£€æŸ¥æ–‡ä»¶æ•°: 233ä¸ª
- æ¶æ„è¿å: **0å¤„**
- æ— è·¨å±‚ç›´æ¥è°ƒç”¨
- æ— ç¯å¢ƒæ··æ·†ï¼ˆ2å¤„è·¨ç¯å¢ƒå¼•ç”¨å‡ä¸ºé¢„æœŸè®¾è®¡ï¼‰

---

### çŠ¶æ€ç®¡ç†: 90/100 (ä¼˜ç§€)

**âœ… ä¼˜åŠ¿**:
- **åŒå­˜å‚¨ç­–ç•¥ä¼˜ç§€**
  - `local`: è®¾å¤‡ç‰¹å®šé…ç½®ï¼ˆnotificationsã€playSoundç­‰ï¼‰
  - `sync`: è·¨è®¾å¤‡åŒæ­¥é…ç½®
  - é€šè¿‡`disableCloudSyncing`æ ‡è®°ç²¾ç¡®æ§åˆ¶

- **ç‰ˆæœ¬æ§åˆ¶åŒæ­¥**
  ```javascript
  // é˜²æ­¢æ—§ç‰ˆæœ¬è¦†ç›–æ–°ç‰ˆæœ¬è®¾ç½®
  if (semvergte(localVersion, syncVersion)) {
    await storage.write(SETTINGS_STORAGE_KEY, newOptionValues, 'sync')
  }
  ```

- **æ™ºèƒ½åˆå¹¶ç­–ç•¥**
  - äº‘ç«¯åŒæ­¥æ—¶ä¿ç•™æœ¬åœ°å­˜å‚¨çš„è®¾å¤‡ç‰¹å®šé€‰é¡¹
  - `mergeSettings`æ ¹æ®optionStorageAreaMapåŠ¨æ€é€‰æ‹©å­˜å‚¨åŒºåŸŸ

- **è·¨è®¾å¤‡åŒæ­¥**
  - ç›‘å¬`chrome.storage.onChanged`
  - å¹¿æ’­`SETTINGS_CHANGED`æ¶ˆæ¯é€šçŸ¥æ‰€æœ‰æ¨¡å—

**âš ï¸ ä¸è¶³**:
- Portæ–­å¼€æœŸé—´çš„è®¾ç½®å˜æ›´å¹¿æ’­ä¼šä¸¢å¤±ï¼ˆä½†é‡è¿åä¼šé‡æ–°è¯»å–ï¼‰
- æ— è®¾ç½®å†²çªè§£å†³æœºåˆ¶ï¼ˆä¾èµ–ç‰ˆæœ¬å·æ¯”è¾ƒï¼‰

---

## ğŸ” å®‰å…¨å®¡æŸ¥ç»“æœ

### æƒé™ä½¿ç”¨: 78/100

**å·²å£°æ˜æƒé™**:
```json
"permissions": [
  "tabs",           â† å»ºè®®æ”¹ä¸ºactiveTabï¼ˆé™ä½æƒé™èŒƒå›´ï¼‰
  "notifications",  âœ… åˆç†
  "contextMenus",   âœ… åˆç†
  "storage",        âœ… åˆç†
  "offscreen",      âœ… åˆç†ï¼ˆMV3éœ€è¦ï¼‰
  "scripting",      âœ… åˆç†
  "alarms"          âœ… åˆç†
]
```

**host_permissions**:
```json
[
  "http://*.fanfou.com/",   âœ… æ ¸å¿ƒåŠŸèƒ½éœ€è¦
  "https://*.fanfou.com/",  âœ… æ ¸å¿ƒåŠŸèƒ½éœ€è¦
  "https://setq.me/"        âš ï¸ éœ€è¦è¯´æ˜ç”¨é€”
]
```

**å»ºè®®ä¼˜åŒ–**:
1. **tabs â†’ activeTab**: é™ä½æƒé™èŒƒå›´ï¼ˆä¸­å±ï¼‰
2. **è¯´æ˜setq.meç”¨é€”**: åœ¨manifestæˆ–æ–‡æ¡£ä¸­è¯´æ˜ï¼ˆé€æ˜åº¦æ”¹å–„ï¼‰
3. **CSPé…ç½®**: å½“å‰`script-src 'self'`å·²è¾ƒä¸¥æ ¼ âœ…

---

### Manifest V3å…¼å®¹æ€§: 95/100 (ä¼˜ç§€)

**âœ… å·²å®ŒæˆMV3è¿ç§»**:
- âœ… æ— åºŸå¼ƒAPIæ®‹ç•™
  - æœªå‘ç°`browser.*`
  - æœªå‘ç°`webkitNotifications`
  - æœªå‘ç°`chrome.extension.*`
  - æœªå‘ç°`chrome.browserAction`ï¼ˆå·²æ”¹ä¸ºactionï¼‰

- âœ… Service Workeræ­£ç¡®é…ç½®
  ```json
  "background": {
    "service_worker": "background.js"
  }
  ```

- âœ… CSP Level 3é…ç½®
  ```json
  "content_security_policy": {
    "extension_pages": "script-src 'self'; object-src 'none'"
  }
  ```

- âœ… æœ€è¿‘ä¿®å¤è®°å½•
  - commit 4acbbab: å½»åº•ä¿®å¤contextMenus Manifest V3å…¼å®¹æ€§é—®é¢˜

**Chrome APIä½¿ç”¨ç»Ÿè®¡**:
| API | ä½¿ç”¨æ¬¡æ•° | æ–‡ä»¶æ•° |
|-----|---------|--------|
| chrome.storage | 19 | 8 |
| chrome.runtime | 18 | 6 |
| chrome.notifications | 8 | 3 |
| chrome.tabs | 7 | 3 |
| chrome.scripting | 2 | 2 |
| chrome.alarms | 2 | 1 |
| chrome.offscreen | 2 | 1 |
| chrome.contextMenus | 7 | 1 |

**âš ï¸ ä»…å‰©é—®é¢˜**:
- Google Analyticsæœªç»ç”¨æˆ·åŒæ„æ”¶é›†æ•°æ®ï¼ˆGDPRåˆè§„æ€§é—®é¢˜ï¼‰
  - å»ºè®®: æ·»åŠ ç”¨æˆ·åŒæ„æç¤ºæˆ–æ”¹ä¸ºopt-in

---

## ğŸ“ˆ æµ‹è¯•è¦†ç›–ç‡åˆ†æ

### å•å…ƒæµ‹è¯•ç°çŠ¶

**å½“å‰é…ç½®**:
- æµ‹è¯•æ¡†æ¶: Jest 24.7.1
- æµ‹è¯•æ–‡ä»¶: ä»…å‘ç°1ä¸ªæµ‹è¯•æ–‡ä»¶ï¼ˆ`libs/memoize.test.js`ï¼‰
- è¦†ç›–ç‡å·¥å…·: æœªé…ç½®Istanbul/NYC

**æµ‹è¯•è¿è¡Œç»“æœ**:
- ESLintæ£€æŸ¥: âœ… é€šè¿‡ï¼ˆä¿®å¤parserå´©æºƒåï¼‰
- å•å…ƒæµ‹è¯•: éœ€è¦è¿›ä¸€æ­¥è¿è¡Œï¼ˆnpm testæ­£åœ¨æ‰§è¡Œï¼‰

**å»ºè®®**:
1. **ä¸ºé«˜å±é€»è¾‘é”™è¯¯æ·»åŠ å•å…ƒæµ‹è¯•**
   - refresh-status-countè¾¹ç•Œæ¡ä»¶
   - checkMyNewStatusç©ºå€¼å¤„ç†
   - messaging.js deferredæ¸…ç†

2. **è¾¹ç•Œæ¡ä»¶æµ‹è¯•**
   - null/undefinedå¤„ç†
   - ç©ºæ•°ç»„/ç©ºå¯¹è±¡
   - DOMæŸ¥è¯¢å¤±è´¥

3. **é…ç½®Istanbulç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š**
   ```json
   "scripts": {
     "test:coverage": "jest --coverage"
   }
   ```

4. **é›†æˆæµ‹è¯•**
   - Service Workerä¼‘çœ /å”¤é†’
   - Porté‡è¿æœºåˆ¶
   - è®¾ç½®è·¨è®¾å¤‡åŒæ­¥

**é¢„è®¡å·¥ä½œé‡**: 16å°æ—¶

---

## ğŸ“ TODO/FIXMEå¤„ç†å»ºè®®

### 14ä¸ªæ ‡è®°åˆ†ç±»ä¸å¤„ç†æ–¹æ¡ˆ

**ğŸ”´ é«˜ä¼˜å…ˆçº§ï¼ˆéœ€ç«‹å³å¤„ç†ï¼‰**: 2ä¸ª

| ä½ç½® | å†…å®¹ | å¤„ç†å»ºè®® |
|------|------|---------|
| urlHandlers.js:47 | Chromeè·¨åŸŸé™åˆ¶æ— è§£ | æ–‡æ¡£åŒ–ä¸ºå·²çŸ¥é™åˆ¶ï¼Œæˆ–ä½¿ç”¨ä»£ç†æœåŠ¡ |
| pageDetect.js:145 | ç…§ç‰‡å¤§å›¾é¡µé¢åˆ¤æ–­æœ‰é—®é¢˜ | ä¿®å¤URLè§£æé€»è¾‘ï¼Œæ·»åŠ å•å…ƒæµ‹è¯• |

---

**ğŸŸ¡ ä¸­ä¼˜å…ˆçº§ï¼ˆå¯è®¡åˆ’å¤„ç†ï¼‰**: 5ä¸ª

| ä½ç½® | å†…å®¹ | å¤„ç†å»ºè®® |
|------|------|---------|
| isStatusElement.js:5 | éœ€è¦æ›´å¥½çš„è§£å†³æ–¹æ³• | æ·»åŠ data-*å±æ€§ä½œä¸ºå¯é æ ‡è®° |
| enrich-statuses@page.js:121 | ä¸Šä¸‹æ–‡æ¶ˆæ¯æ— æ³•å¤„ç† | ä¿®æ”¹isStatusElementæˆ–æ·»åŠ ä¸“é—¨é€»è¾‘ |
| urlHandlers.js:71 | ç¼©ç•¥å›¾æ˜¾ç¤ºé—®é¢˜ | åˆ†æAPIå˜åŒ–ï¼Œæ›´æ–°è§£æé€»è¾‘ |
| refresh-status-count@page.js:47 | æ–°æ¶ˆæ¯ç¿»é¡µå¤„ç† | æ·»åŠ æ—¶é—´æˆ³åˆ¤æ–­æˆ–ç›‘å¬æ»šåŠ¨äº‹ä»¶ |
| fix-photo-zoom/@page.js:5 | äº‹ä»¶ç»‘å®šä¼˜åŒ– | è¯„ä¼°æ˜¯å¦å€¼å¾—é‡æ„ |

---

**ğŸŸ¢ ä½ä¼˜å…ˆçº§ï¼ˆå¯å»¶åï¼‰**: 5ä¸ª

| ä½ç½® | å†…å®¹ | å¤„ç†å»ºè®® |
|------|------|---------|
| 90-simplified-view.less:37 | ä»£ç åˆå¹¶ä¼˜åŒ– | æ ·å¼é‡æ„æ—¶å¤„ç† |
| enrich-statuses@page.js:80 | ç¼“å­˜ä¼˜åŒ– | å·²çº³å…¥æ€§èƒ½ä¼˜åŒ–è®¡åˆ’ |
| timelineElementObserver.js:8 | å›è°ƒåˆ†ç¦» | æ€§èƒ½ä¼˜åŒ–æ—¶ä¸€å¹¶å¤„ç† |
| share-to-fanfou@background.js:12 | æ‹¿ä¸åˆ°é“¾æ¥æ ‡é¢˜ | Chrome APIé™åˆ¶ï¼Œå½±å“è¾ƒå° |
| widgets.css:88,117 | UIæ ·å¼å®Œå–„ | è®¾è®¡ä¼˜åŒ–æ—¶å¤„ç† |

---

**âš« å·²è¿‡æ—¶ï¼ˆå¯åˆ é™¤ï¼‰**: 2ä¸ª

| ä½ç½® | å†…å®¹ | å¤„ç†å»ºè®® |
|------|------|---------|
| animatedScrollTopç›¸å…³ | å·²å®ç°çš„æ³¨é‡Š | æ¸…ç†æ³¨é‡Š |
| å¤šå¤„ | æ³¨é‡Šæ‰çš„ä»£ç å— | æ¸…ç†æˆ–æ·»åŠ è¯´æ˜ |

---

## ğŸ¯ ä¿®å¤ä¼˜å…ˆçº§è·¯çº¿å›¾

### Phase 1: ç´§æ€¥ä¿®å¤ï¼ˆæœ¬å‘¨å®Œæˆï¼‰

**é¢„è®¡æ—¶é—´**: 8å°æ—¶
**ä¼˜å…ˆçº§**: P0
**äº¤ä»˜ç›®æ ‡**: æ¶ˆé™¤æ‰€æœ‰ä¼šå¯¼è‡´å´©æºƒçš„é«˜å±é—®é¢˜

**ä»»åŠ¡æ¸…å•**:
- [x] ~~ä¿®å¤ESLint parserå´©æºƒ~~ (å·²å®Œæˆ)
- [ ] ğŸ› #1: refresh-status-countç©ºå€¼å¼•ç”¨ï¼ˆ15åˆ†é’Ÿï¼‰
- [ ] ğŸ› #2: DOMå…ƒç´ ç©ºå€¼è®¿é—®ï¼ˆ10åˆ†é’Ÿï¼‰
- [ ] ğŸ› #3: undefinedåœ¨mapä¸­ä¼ æ’­ï¼ˆ10åˆ†é’Ÿï¼‰
- [ ] ğŸ› #4: é“¾å¼è°ƒç”¨nullæ£€æŸ¥ï¼ˆ10åˆ†é’Ÿï¼‰
- [ ] ğŸ”’ #5: XSSæ¼æ´ä¿®å¤ï¼ˆ1å°æ—¶ï¼‰
- [ ] ğŸ”’ #6: ä¾èµ–å®‰å…¨å‡çº§ï¼ˆ2-4å°æ—¶ï¼‰
- [ ] å›å½’æµ‹è¯•ï¼ˆ1å°æ—¶ï¼‰

**éªŒæ”¶æ ‡å‡†**:
- âœ… npm testé€šè¿‡
- âœ… npm run buildæˆåŠŸ
- âœ… æ‰‹åŠ¨æµ‹è¯•æ ¸å¿ƒåŠŸèƒ½æ— å´©æºƒ
- âœ… npm auditæ— é«˜å±æ¼æ´

---

### Phase 2: ç¨³å®šæ€§æ”¹å–„ï¼ˆæœ¬æœˆå®Œæˆï¼‰

**é¢„è®¡æ—¶é—´**: 16å°æ—¶
**ä¼˜å…ˆçº§**: P1
**äº¤ä»˜ç›®æ ‡**: æå‡ä»£ç è´¨é‡åŸºçº¿ï¼Œæ”¹å–„æ€§èƒ½

**ä»»åŠ¡æ¸…å•**:
- [ ] ğŸ“‹ #18: æ¸…ç†125ä¸ªESLinté”™è¯¯ï¼ˆ2å°æ—¶ï¼‰
- [ ] ğŸ—ï¸ #15: æ·»åŠ æ¶ˆæ¯é‡è¯•æœºåˆ¶ï¼ˆ2å°æ—¶ï¼‰
- [ ] ğŸ› #7-11: ä¿®å¤5ä¸ªä¸­å±é€»è¾‘éšæ‚£ï¼ˆ3å°æ—¶ï¼‰
- [ ] âš¡ #13: å®ç°enrich-statusesç¼“å­˜ï¼ˆ1.5å°æ—¶ï¼‰
- [ ] âš¡ #12: ä¼˜åŒ–page.jsä½“ç§¯ï¼ˆ8å°æ—¶ï¼‰
  - å‡çº§Webpack 5
  - é…ç½®ä»£ç åˆ†å‰²
  - Tree-shakingä¼˜åŒ–
- [ ] ğŸ” æƒé™ä¼˜åŒ–ï¼štabs â†’ activeTabï¼ˆ30åˆ†é’Ÿï¼‰
- [ ] å›å½’æµ‹è¯•ï¼ˆ2å°æ—¶ï¼‰

**éªŒæ”¶æ ‡å‡†**:
- âœ… ESLinté”™è¯¯ < 10ä¸ª
- âœ… page.jsä½“ç§¯ < 500KB
- âœ… ç¼“å­˜å‘½ä¸­ç‡ > 80%ï¼ˆçŸ­é“¾æ¥å±•å¼€ï¼‰
- âœ… æ€§èƒ½è¯„åˆ†æå‡ > 10åˆ†

---

### Phase 3: è´¨é‡æå‡ï¼ˆä¸‹å­£åº¦å®Œæˆï¼‰

**é¢„è®¡æ—¶é—´**: 40å°æ—¶
**ä¼˜å…ˆçº§**: P2
**äº¤ä»˜ç›®æ ‡**: é•¿æœŸå¯ç»´æŠ¤æ€§æ”¹å–„

**ä»»åŠ¡æ¸…å•**:
- [ ] é‡æ„3ä¸ªä½è¯„åˆ†æ¨¡å—ï¼ˆ12å°æ—¶ï¼‰
  - show-contextual-statusesæ‹†åˆ†
  - sidebar-statisticsè®¡ç®—é€»è¾‘æå–
  - batch-remove-statusesé”™è¯¯å¤„ç†
- [ ] æ·»åŠ å•å…ƒæµ‹è¯•è¦†ç›–å…³é”®è·¯å¾„ï¼ˆ16å°æ—¶ï¼‰
  - æ ¸å¿ƒåŠŸèƒ½æµ‹è¯•ï¼ˆnotificationsã€messagingç­‰ï¼‰
  - è¾¹ç•Œæ¡ä»¶æµ‹è¯•
  - Service Workerç”Ÿå‘½å‘¨æœŸæµ‹è¯•
- [ ] æå–é‡å¤ä»£ç ä¸ºå·¥å…·å‡½æ•°ï¼ˆ6å°æ—¶ï¼‰
- [ ] æå‡æ³¨é‡Šè¦†ç›–ç‡åˆ°50%ï¼ˆ8å°æ—¶ï¼‰
- [ ] è¡¥å……æ¶æ„å†³ç­–æ–‡æ¡£ï¼ˆ2å°æ—¶ï¼‰
- [ ] è¯„ä¼°TypeScriptè¿ç§»å¯è¡Œæ€§ï¼ˆç ”ç©¶ï¼Œä¸è®¡æ—¶ï¼‰

**éªŒæ”¶æ ‡å‡†**:
- âœ… æµ‹è¯•è¦†ç›–ç‡ > 60%
- âœ… æ³¨é‡Šè¦†ç›–ç‡ > 50%
- âœ… æ¨¡å—å¹³å‡è¯„åˆ† > 80åˆ†
- âœ… ä»£ç é‡å¤ç‡ < 5%

---

## ğŸ“Š ç»Ÿè®¡æ•°æ®æ€»è§ˆ

### ä»£ç åº“è§„æ¨¡

| æŒ‡æ ‡ | æ•°å€¼ |
|------|------|
| æ€»æ–‡ä»¶æ•° | 233ä¸ªJSæ–‡ä»¶ |
| ä»£ç è¡Œæ•° | 13,209è¡Œ |
| åŠŸèƒ½æ¨¡å—æ•° | 30ä¸ª |
| å¹³å‡æ–‡ä»¶å¤§å° | 57è¡Œ/æ–‡ä»¶ |
| å¹³å‡åœˆå¤æ‚åº¦ | ~3.5 |

### Bugå‘ç°ç»Ÿè®¡

| ç±»å‹ | é«˜å± | ä¸­å± | ä½å± | åˆè®¡ |
|------|------|------|------|------|
| é€»è¾‘é”™è¯¯ | 4 | 5 | 3 | 12 |
| å®‰å…¨é—®é¢˜ | 2 | 4 | 2 | 8 |
| æ¶æ„å€ºåŠ¡ | 0 | 3 | 1 | 4 |
| æ€§èƒ½é—®é¢˜ | 0 | 3 | 2 | 5 |
| ä»£ç è´¨é‡ | 1 | 2 | 3 | 6 |
| **æ€»è®¡** | **7** | **17** | **11** | **35** |

### ä»£ç è´¨é‡æŒ‡æ ‡

| æŒ‡æ ‡ | å½“å‰å€¼ | ç›®æ ‡å€¼ | ç¼ºå£ |
|------|--------|--------|------|
| ESLinté”™è¯¯ | 125ä¸ª | < 10ä¸ª | -115 |
| JSDocè¦†ç›–ç‡ | 0% | 30% | +30% |
| æ³¨é‡Šè¦†ç›–ç‡ | 24% | 50% | +26% |
| æµ‹è¯•è¦†ç›–ç‡ | æœªçŸ¥ | 60% | +60% |
| ä»£ç é‡å¤ç‡ | ~8% | < 5% | -3% |

### æ€§èƒ½æŒ‡æ ‡

| æŒ‡æ ‡ | å½“å‰å€¼ | ç›®æ ‡å€¼ | æ”¹å–„ç©ºé—´ |
|------|--------|--------|----------|
| page.jså¤§å° | 596 KB | 450 KB | -25% |
| content.jså¤§å° | 124 KB | 100 KB | -20% |
| background.jså¤§å° | 176 KB | 150 KB | -15% |
| ç¼“å­˜å‘½ä¸­ç‡ | 0% | 80% | +80% |

---

## ğŸ† é¡¹ç›®ä¼˜åŠ¿æ€»ç»“

### 1. æ¶æ„è®¾è®¡æˆç†Ÿ (91/100)

**å››å±‚ç»“æ„æ¸…æ™°**:
- Background Scripts: Service Workerï¼Œå¤„ç†æŒç»­ä»»åŠ¡
- Content Scripts: DOMæ“ä½œï¼Œéš”ç¦»ç¯å¢ƒ
- Page Scripts: è°ƒç”¨é¥­å¦APIï¼Œé¡µé¢ä¸Šä¸‹æ–‡
- Settings: æ‰©å±•è®¾ç½®é¡µé¢

**è®¾è®¡äº®ç‚¹**:
- âœ… Content/PageåŒå±‚è®¾è®¡åˆç†ï¼ˆæœ‰æ„ä¸ºä¹‹ï¼Œéå†—ä½™ï¼‰
- âœ… CustomEventæ¡¥æ¥æœºåˆ¶ç¨³å®š
- âœ… Service Workerä¼‘çœ æ¢å¤æœºåˆ¶å®Œå–„

---

### 2. æ¨¡å—ç³»ç»Ÿè§„èŒƒ (95/100)

**100%è§„èŒƒç¬¦åˆ**:
- âœ… æ–‡ä»¶å‘½åè§„èŒƒ100%ç¬¦åˆ
- âœ… metadata.jsé…ç½®100%ç¬¦åˆ
- âœ… æ¡ä»¶ç¼–è¯‘éš”ç¦»è‰¯å¥½
- âœ… é›¶é…ç½®è‡ªåŠ¨åŠ è½½ï¼ˆimport-all.macroï¼‰

**ç»Ÿè®¡éªŒè¯**:
- 0å¤„æ¶æ„è¿å
- 0å¤„è·¨å±‚ç›´æ¥è°ƒç”¨
- 0å¤„ç¯å¢ƒæ··æ·†ï¼ˆé¢„æœŸçš„è·¨ç¯å¢ƒå¼•ç”¨å·²è¯†åˆ«ï¼‰

---

### 3. çŠ¶æ€åŒæ­¥ç­–ç•¥ä¼˜ç§€ (90/100)

**åŒå­˜å‚¨+ç‰ˆæœ¬æ§åˆ¶**:
- âœ… local vs syncç²¾ç¡®æ§åˆ¶
- âœ… ç‰ˆæœ¬å·é˜²æ­¢æ—§ç‰ˆè¦†ç›–æ–°ç‰ˆ
- âœ… æ™ºèƒ½åˆå¹¶äº‘ç«¯/æœ¬åœ°è®¾ç½®

**è·¨è®¾å¤‡åŒæ­¥**:
- âœ… chrome.storage.onChangedç›‘å¬
- âœ… å¹¿æ’­æœºåˆ¶é€šçŸ¥æ‰€æœ‰æ¨¡å—
- âœ… è®¾å¤‡ç‰¹å®šé€‰é¡¹æ­£ç¡®éš”ç¦»

---

### 4. MV3è¿ç§»å®Œæ•´ (95/100)

**é›¶åºŸå¼ƒAPI**:
- âœ… æ— browser.*å¼•ç”¨
- âœ… æ— webkitNotifications
- âœ… æ— chrome.extension.*
- âœ… æ— chrome.browserAction

**Service Workerå®è·µ**:
- âœ… é˜²é‡å¤åˆå§‹åŒ–
- âœ… Portè‡ªåŠ¨é‡è¿
- âœ… çŠ¶æ€æŒä¹…åŒ–

---

## ğŸ’¡ æ ¸å¿ƒå»ºè®®ä¸è¡ŒåŠ¨è®¡åˆ’

### ç«‹å³è¡ŒåŠ¨ï¼ˆæœ¬å‘¨ï¼‰

**å…³é”®é—®é¢˜**:
1. âœ… ~~ESLint parserå´©æºƒ~~ (å·²ä¿®å¤)
2. ğŸ”´ 4ä¸ªä¼šå¯¼è‡´å´©æºƒçš„é€»è¾‘é”™è¯¯
3. ğŸ”’ XSSæ¼æ´ï¼ˆå®‰å…¨é£é™©ï¼‰
4. ğŸ”’ ä¾èµ–CVEæ¼æ´ï¼ˆä¾›åº”é“¾å®‰å…¨ï¼‰

**è¡ŒåŠ¨æ­¥éª¤**:
```bash
# 1. ä¿®å¤é€»è¾‘é”™è¯¯ï¼ˆæ‰‹åŠ¨ä¿®æ”¹4ä¸ªæ–‡ä»¶ï¼‰
vim src/features/status-form-enhancements/refresh-status-count@page.js
vim src/page/modules/checkMyNewStatus.js

# 2. ä¿®å¤XSSæ¼æ´
# åœ¨show-contextual-statuses/@page.jsä¸­ä½¿ç”¨DOMPurify

# 3. å‡çº§ä¾èµ–
npm update webpack@5.x.x dot-prop@8.0.0
npm audit fix

# 4. éªŒè¯
npm test
npm run build
```

---

### çŸ­æœŸæ”¹è¿›ï¼ˆæœ¬æœˆï¼‰

**é‡ç‚¹ä»»åŠ¡**:
1. æ¸…ç†ESLinté”™è¯¯ï¼ˆæå‡ä»£ç è´¨é‡åŸºçº¿ï¼‰
2. æ·»åŠ ç¼“å­˜æœºåˆ¶ï¼ˆæ”¹å–„æ€§èƒ½å’ŒAPIé™æµï¼‰
3. ä¼˜åŒ–Bundle Sizeï¼ˆå‡å°‘30%ä½“ç§¯ï¼‰
4. æ¶ˆæ¯é‡è¯•æœºåˆ¶ï¼ˆæå‡å¯é æ€§ï¼‰

**é¢„æœŸæ”¶ç›Š**:
- ä»£ç è´¨é‡è¯„åˆ†: 72 â†’ 85
- æ€§èƒ½è¯„åˆ†: 80 â†’ 88
- é¡¹ç›®å¥åº·åº¦: 82 â†’ 90

---

### é•¿æœŸä¼˜åŒ–ï¼ˆä¸‹å­£åº¦ï¼‰

**æˆ˜ç•¥ç›®æ ‡**:
1. å»ºç«‹æµ‹è¯•ä½“ç³»ï¼ˆè¦†ç›–ç‡60%+ï¼‰
2. é‡æ„ä½è¯„åˆ†æ¨¡å—ï¼ˆå¯ç»´æŠ¤æ€§ï¼‰
3. æ–‡æ¡£åŒ–æ”¹å–„ï¼ˆæ³¨é‡Š50%+ï¼‰
4. è€ƒè™‘TypeScriptè¿ç§»ï¼ˆç±»å‹å®‰å…¨ï¼‰

**é¢„æœŸæ”¶ç›Š**:
- æµ‹è¯•è¦†ç›–ç‡: 0% â†’ 60%
- æ³¨é‡Šè¦†ç›–ç‡: 24% â†’ 50%
- æ¨¡å—å¹³å‡è¯„åˆ†: 78 â†’ 85
- Bugå‘ç°æ—¶é—´: å‡å°‘40%

---

## ğŸ“ é™„å½•

### A. æ£€æŸ¥æ–¹æ³•è®º

**ä½¿ç”¨çš„ä¸“ä¸šä»£ç†**:
1. **debugger**: é€»è¾‘é”™è¯¯æ·±åº¦æ£€æŸ¥
2. **security-auditor**: å®‰å…¨é—®é¢˜å…¨é¢å®¡æŸ¥
3. **code-reviewer**: ä»£ç è´¨é‡æ£€æŸ¥
4. **architect-review**: æ¶æ„å®Œæ•´æ€§éªŒè¯
5. **performance-engineer**: æ€§èƒ½é—®é¢˜åˆ†æ

**æ£€æŸ¥èŒƒå›´**:
- 233ä¸ªJSæ–‡ä»¶
- 30ä¸ªåŠŸèƒ½æ¨¡å—
- 17ä¸ªä½¿ç”¨Chrome APIçš„æ–‡ä»¶
- 25ä¸ªTODO/FIXMEæ ‡è®°

**æ£€æŸ¥æ—¶é•¿**: çº¦4å°æ—¶ï¼ˆè‡ªåŠ¨åŒ–+äººå·¥ï¼‰

---

### B. å‚è€ƒæ ‡å‡†

- OWASP Top 10 for Chrome Extensions
- Chrome Web Storeæ”¿ç­–åˆè§„æ€§
- CSP Level 3æœ€ä½³å®è·µ
- Manifest V3å®‰å…¨æŒ‡å—
- ESLintæ¨èè§„åˆ™é›†

---

### C. ç›¸å…³æ–‡æ¡£

- [æ¶æ„æ–‡æ¡£](./architecture.md)
- [å‘å¸ƒæµç¨‹](./publish.md)
- [è´¡çŒ®æŒ‡å—](./contributing.md)
- [é¡¹ç›®README](../README.md)

---

### D. å˜æ›´è®°å½•

| æ—¥æœŸ | ç‰ˆæœ¬ | å˜æ›´å†…å®¹ |
|------|------|---------|
| 2025-11-11 | v1.0 | åˆå§‹ç‰ˆæœ¬ï¼Œå…¨é¢Bugæ£€æŸ¥æŠ¥å‘Š |

---

**æŠ¥å‘Šç»“æŸ**

å¦‚éœ€è¿›ä¸€æ­¥æ¾„æ¸…æˆ–è¯¦ç»†åˆ†æï¼Œè¯·å‚è€ƒå„ç« èŠ‚çš„è¯¦ç»†è¯´æ˜æˆ–è”ç³»å¼€å‘å›¢é˜Ÿã€‚
